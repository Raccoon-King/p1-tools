{
  "P1 AI Configuration": {
    "prefix": "p1-ai-config",
    "body": [
      "# P1 Dev Guard AI Configuration",
      "default_model: ${1:claude-3-haiku}",
      "models:",
      "  ${1:claude-3-haiku}:",
      "    name: Claude 3 Haiku",
      "    provider: bedrock",
      "    model_id: anthropic.claude-3-haiku-20240307-v1:0",
      "    max_tokens: ${2:4000}",
      "    temperature: ${3:0.1}",
      "    region: ${4:us-east-1}",
      "    cost_per_1k_input: 0.00025",
      "    cost_per_1k_output: 0.00125",
      "    capabilities: [analysis, remediation, code_generation]",
      "    enabled: true",
      "",
      "analysis:",
      "  enabled: true",
      "  fallback_enabled: true",
      "  max_retries: ${5:3}",
      "  timeout_seconds: ${6:30}",
      "  analysis_depth: ${7:standard}",
      "  include_code_examples: true",
      "  include_prevention_tips: true",
      "  priority_threshold: ${8:medium}",
      "  max_issues_per_request: ${9:10}",
      "",
      "custom_prompts:",
      "  security_focus: |",
      "    You are a cybersecurity expert specializing in Kubernetes and container security.",
      "    Focus heavily on security implications and provide detailed security remediation."
    ],
    "description": "P1 Dev Guard AI configuration template"
  },
  "P1 Helm Chart Template": {
    "prefix": "p1-helm-chart",
    "body": [
      "apiVersion: v2",
      "name: ${1:chart-name}",
      "description: ${2:A Big Bang compliant Helm chart}",
      "type: application",
      "version: ${3:0.1.0}",
      "appVersion: ${4:1.0.0}",
      "",
      "keywords:",
      "  - ${5:application}",
      "  - platform-one",
      "  - big-bang",
      "",
      "home: ${6:https://repo1.dso.mil/}",
      "sources:",
      "  - ${7:https://repo1.dso.mil/}",
      "",
      "maintainers:",
      "  - name: ${8:Platform One}",
      "    email: ${9:support@platform-one.mil}",
      "",
      "dependencies: []",
      "",
      "annotations:",
      "  bigbang.dev/applicationVersions: |",
      "    - ${1:chart-name}: ${4:1.0.0}"
    ],
    "description": "Big Bang compliant Helm Chart.yaml template"
  },
  "P1 Values Schema": {
    "prefix": "p1-values-schema",
    "body": [
      "{",
      "  \"$schema\": \"https://json-schema.org/draft-07/schema#\",",
      "  \"type\": \"object\",",
      "  \"title\": \"${1:Chart Name} Values Schema\",",
      "  \"description\": \"Schema for ${1:Chart Name} Helm chart values\",",
      "  \"required\": [\"${2:image}\", \"${3:replicaCount}\"],",
      "  \"properties\": {",
      "    \"${2:image}\": {",
      "      \"type\": \"object\",",
      "      \"required\": [\"repository\", \"tag\"],",
      "      \"properties\": {",
      "        \"repository\": {",
      "          \"type\": \"string\",",
      "          \"pattern\": \"^\\\\$\\\\{IRONBANK_MIRROR\\\\}/.*\"",
      "        },",
      "        \"tag\": {",
      "          \"type\": \"string\",",
      "          \"pattern\": \"^[^:]*@sha256:[a-f0-9]{64}$\"",
      "        },",
      "        \"pullPolicy\": {",
      "          \"type\": \"string\",",
      "          \"enum\": [\"Always\", \"IfNotPresent\", \"Never\"],",
      "          \"default\": \"IfNotPresent\"",
      "        }",
      "      }",
      "    },",
      "    \"${3:replicaCount}\": {",
      "      \"type\": \"integer\",",
      "      \"minimum\": 1,",
      "      \"default\": 1",
      "    },",
      "    \"resources\": {",
      "      \"type\": \"object\",",
      "      \"required\": [\"requests\", \"limits\"],",
      "      \"properties\": {",
      "        \"requests\": {",
      "          \"type\": \"object\",",
      "          \"required\": [\"memory\", \"cpu\"],",
      "          \"properties\": {",
      "            \"memory\": { \"type\": \"string\" },",
      "            \"cpu\": { \"type\": \"string\" }",
      "          }",
      "        },",
      "        \"limits\": {",
      "          \"type\": \"object\",",
      "          \"required\": [\"memory\", \"cpu\"],",
      "          \"properties\": {",
      "            \"memory\": { \"type\": \"string\" },",
      "            \"cpu\": { \"type\": \"string\" }",
      "          }",
      "        }",
      "      }",
      "    }",
      "  }",
      "}"
    ],
    "description": "Big Bang compliant values.schema.json template"
  },
  "P1 Network Policy": {
    "prefix": "p1-netpol",
    "body": [
      "apiVersion: networking.k8s.io/v1",
      "kind: NetworkPolicy",
      "metadata:",
      "  name: ${1:app-name}-netpol",
      "  namespace: {{ .Values.namespace | default .Release.Namespace }}",
      "  labels:",
      "    {{- include \"${1:app-name}.labels\" . | nindent 4 }}",
      "spec:",
      "  podSelector:",
      "    matchLabels:",
      "      {{- include \"${1:app-name}.selectorLabels\" . | nindent 6 }}",
      "  policyTypes:",
      "    - Ingress",
      "    - Egress",
      "  ingress:",
      "    - from:",
      "        - podSelector:",
      "            matchLabels:",
      "              app.kubernetes.io/name: ${2:allowed-app}",
      "      ports:",
      "        - protocol: TCP",
      "          port: ${3:8080}",
      "  egress:",
      "    - to:",
      "        - namespaceSelector:",
      "            matchLabels:",
      "              name: ${4:kube-system}",
      "      ports:",
      "        - protocol: TCP",
      "          port: ${5:53}",
      "        - protocol: UDP",
      "          port: ${5:53}"
    ],
    "description": "Big Bang NetworkPolicy template"
  },
  "P1 OPA Policy": {
    "prefix": "p1-opa-policy",
    "body": [
      "package ${1:policy_name}",
      "",
      "import rego.v1",
      "",
      "# ${2:Policy description}",
      "violation[msg] if {",
      "\t${3:# Condition logic}",
      "\tinput.kind == \"${4:Pod}\"",
      "\tnot ${5:compliant_condition}",
      "\tmsg := \"${6:Violation message}\"",
      "}",
      "",
      "compliant_condition if {",
      "\t${7:# Compliance check logic}",
      "\ttrue",
      "}",
      "",
      "# Utility functions",
      "has_label(label_key) if {",
      "\tinput.metadata.labels[label_key]",
      "}",
      "",
      "is_ironbank_image if {",
      "\tcontains(input.spec.containers[_].image, \"${IRONBANK_MIRROR}\")",
      "}",
      "",
      "has_resource_limits if {",
      "\tinput.spec.containers[_].resources.limits",
      "}"
    ],
    "description": "OPA/Rego policy template for Big Bang compliance"
  },
  "P1 Container Scan Task": {
    "prefix": "p1-scan-task",
    "body": [
      "{",
      "  \"label\": \"P1: ${1:Custom Scan}\",",
      "  \"type\": \"shell\",",
      "  \"command\": \"docker\",",
      "  \"args\": [",
      "    \"run\",",
      "    \"--rm\",",
      "    \"-v\",",
      "    \"\\${workspaceFolder}:/workspace\",",
      "    \"-e\",",
      "    \"AWS_PROFILE=\\${env:AWS_PROFILE}\",",
      "    \"-v\",",
      "    \"\\${env:HOME}/.aws:/root/.aws:ro\",",
      "    \"\\${config:p1devguard.containerImage}\",",
      "    \"${2:--chart}\",",
      "    \"${3:./helm/app}\",",
      "    \"--ai-model\",",
      "    \"\\${config:p1devguard.aiModel}\"",
      "  ],",
      "  \"group\": \"${4:test}\",",
      "  \"presentation\": {",
      "    \"echo\": true,",
      "    \"reveal\": \"always\",",
      "    \"focus\": ${5:true},",
      "    \"panel\": \"${6:shared}\"",
      "  }",
      "}"
    ],
    "description": "VS Code task for P1 Dev Guard container scan"
  }
}